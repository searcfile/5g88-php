<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>5G88 Admin Panel â€” Tabs</title>
<style>
  :root{
    --bg:#0b1220;
    --bg-soft:#0f1a2b;
    --panel:#0e1626;
    --line:#1d2a3f;
    --text:#e6e8ee;
    --muted:#a9b0c0;
    --gold:#f5c84b;
    --gold-2:#ffe34d;
    --green:#6adf77;
    --red:#ff6b6b;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;background:#030712;color:var(--text);
    font:14px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
  }

  /* Top header */
  .header{
    position:fixed; inset:0 0 auto 0; height:56px; z-index:50;
    display:flex; align-items:center; gap:10px;
    padding:0 12px; background:#071120; border-bottom:1px solid var(--line);
  }
  .site-select{
    display:flex; align-items:center; gap:6px; margin-right:8px;
  }
  .select{
    appearance:none; -webkit-appearance:none; -moz-appearance:none;
    height:34px; padding:0 30px 0 12px; border-radius:8px;
    background:var(--panel); color:var(--text);
    border:1px solid #22314c; cursor:pointer; position:relative;
  }
  .select:focus{outline:none; border-color:var(--gold)}
  .select-wrap{position:relative}
  .select-wrap:after{
    content:""; position:absolute; right:10px; top:50%; margin-top:-2px;
    border:5px solid transparent; border-top-color:#cfd6e6;
    pointer-events:none;
  }

  .nav{
    display:flex; align-items:center; gap:6px; flex:1; overflow:hidden;
  }
  .nav-btn{
    display:flex; align-items:center; gap:8px;
    padding:8px 12px; border-radius:8px; color:#cfd6e6;
    border:1px solid transparent; background:transparent;
    cursor:pointer; white-space:nowrap;
  }
  .nav-btn:hover{background:#0c1a2f; border-color:#1e2e4b}
  .nav-btn.active{background:#123; border-color:#2b3f62; color:#fff}
  .nav-btn svg{opacity:.9}

  /* Right info chips (dummy meters) */
  .chip{
    height:32px; display:inline-flex; align-items:center; gap:8px;
    padding:0 10px; border-radius:8px; background:#0c1729; color:#cfe7d5;
    border:1px solid #20324f; white-space:nowrap;
  }
  .chip.green{color:#baf3c0}
  .chip .dot{width:9px;height:9px;border-radius:50%; background:var(--green)}

  /* Tab bar under header */
  .tabbar-wrap{
    position:fixed; top:56px; left:0; right:0; height:44px; z-index:40;
    background:#050b14; border-bottom:1px solid var(--line);
  }
  .tabbar{
    height:44px; display:flex; align-items:center; gap:8px;
    overflow:auto; scrollbar-width:none; padding:0 10px;
  }
  .tabbar::-webkit-scrollbar{display:none}

  .tab{
    display:flex; align-items:center; gap:10px;
    height:30px; padding:0 10px; border-radius:8px;
    background:#0e192a; color:#cfd6e6; border:1px solid #1d2a3f;
    user-select:none; cursor:pointer; white-space:nowrap;
  }
  .tab.active{background:#13223a; color:#fff; border-color:#2a3d60}
  .tab .close{
    width:18px; height:18px; display:inline-flex; align-items:center; justify-content:center;
    border-radius:6px; color:#b8c0d2; font-weight:700;
  }
  .tab .close:hover{background:#1a2a46; color:#fff}
  .tab.dragging{opacity:.5}

  /* Content area */
  .content{
    position:fixed; top:100px; left:0; right:0; bottom:0; overflow:auto;
    background:var(--bg); padding:16px;
  }
  .panel{
    background:var(--panel); border:1px solid var(--line); border-radius:12px;
    padding:14px; box-shadow:0 6px 20px rgba(0,0,0,.25);
  }
  .panel h2{margin:0 0 12px 0; font-size:18px; font-weight:600}
  .muted{color:var(--muted)}

  /* Transactions table */
  .filters{
    display:flex; flex-wrap:wrap; gap:10px; margin-bottom:12px;
  }
  .input, .button, .badge{
    height:34px; padding:0 10px; border-radius:8px; border:1px solid #22314c;
    background:#0c1729; color:#e7ecf7;
  }
  .input::placeholder{color:#8ea0be}
  .button{
    cursor:pointer; background:linear-gradient(180deg,#132644,#0c1729);
  }
  .button:hover{border-color:var(--gold); box-shadow:0 0 0 2px rgba(245,200,75,.15) inset}
  .button.gold{background:#2a2008; border-color:#3a2c09}
  .button.gold:hover{border-color:var(--gold-2)}
  .badge{display:inline-flex; align-items:center; gap:6px}

  table{width:100%; border-collapse:collapse; overflow:hidden; border-radius:10px}
  th,td{padding:10px 12px; border-bottom:1px solid #1b2740}
  th{background:#0f1c32; text-align:left; color:#d9e2f5; font-weight:600}
  tr:hover td{background:#0d1830}
  .amount.pos{color:#87f59b}
  .amount.neg{color:#ff9b9b}
  .tag{padding:2px 8px; border-radius:20px; border:1px solid #2a3c60; background:#101e36; font-size:12px}
  .right{text-align:right}

  /* Tiny helpers */
  .hidden{display:none}
  .spacer{flex:1}

  @media (max-width:720px){
    .nav{display:none}
    .chip{display:none}
  }
</style>
</head>
<body>

<!-- HEADER -->
<header class="header">
  <div class="site-select">
    <div class="select-wrap">
      <select id="siteSelect" class="select">
        <option value="5G88">5G88</option>
        <option value="SPM888">SPM888</option>
      </select>
    </div>
  </div>

  <nav class="nav" id="topNav">
    <button class="nav-btn" data-tab="Dashboard">
      <!-- icon -->
      <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/></svg>
      Dashboard
    </button>
    <button class="nav-btn" data-tab="Transactions">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M3 6h18v2H3V6zm0 5h12v2H3v-2zm0 5h18v2H3v-2z"/></svg>
      Transactions
    </button>
    <button class="nav-btn" data-tab="Cash Transfer">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M5 5h14v14H5z" opacity=".25"/><path d="M7 12h10M12 7v10" stroke="currentColor" stroke-width="2" fill="none"/></svg>
      Cash Transfer
    </button>
    <button class="nav-btn" data-tab="Player">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-5 0-9 2.5-9 5v1h18v-1c0-2.5-4-5-9-5Z"/></svg>
      Player
    </button>
    <button class="nav-btn" data-tab="Report">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M4 4h16v16H4z" opacity=".2"/><path d="M8 16V8M12 16V6m4 10V10" stroke="currentColor" stroke-width="2" fill="none"/></svg>
      Report
    </button>
    <button class="nav-btn" data-tab="Livechat">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M4 4h16v11H7l-3 3V4z"/></svg>
      Livechat
    </button>
  </nav>

  <div class="spacer"></div>

  <div class="chip green">
    <span class="dot"></span> Bank Meter
  </div>
</header>

<!-- TAB BAR -->
<div class="tabbar-wrap">
  <div id="tabBar" class="tabbar"></div>
</div>

<!-- CONTENT -->
<main id="content" class="content">
  <div class="panel">
    <h2>Selamat datang ðŸ‘‹</h2>
    <div class="muted">Klik item di header (contoh <b>Transactions</b>) untuk buka tab. Tab boleh di-<i>drag</i> susun ikut suka dan boleh ditutup (Ã—). Pilih <b>Site</b> di kiri untuk tukar data.</div>
  </div>
</main>

<script>
/* =========================
   Demo data per SITE
   ========================= */
const DATA = {
  "5G88": {
    transactions: [
      { id:"TX-10021", type:"Deposit",  player:"adam88", amount: 1200,  status:"Success", time:"2025-09-02 14:05" },
      { id:"TX-10022", type:"Withdraw", player:"mimi77", amount:-500,  status:"Pending", time:"2025-09-02 14:16" },
      { id:"TX-10023", type:"Bonus",    player:"jack",   amount: 150,   status:"Success", time:"2025-09-02 14:37" },
      { id:"TX-10024", type:"Deposit",  player:"neo55",  amount: 300,   status:"Failed",  time:"2025-09-02 15:02" },
    ],
    transfers: [
      { from:"Bank A", to:"Bank B", amount: 20000, by:"support2", time:"2025-09-02 13:40" },
      { from:"Bank B", to:"Bank A", amount: 12000, by:"support2", time:"2025-09-02 15:05" },
    ],
    players: [
      { user:"adam88", vip:"Gold", balance: 356.20, last:"2025-09-02 15:11" },
      { user:"mimi77", vip:"Silver", balance: 82.00, last:"2025-09-02 15:06" },
      { user:"neo55",  vip:"Bronze", balance: 0.00, last:"2025-09-02 12:50" },
    ]
  },
  "SPM888": {
    transactions: [
      { id:"TX-20031", type:"Deposit",  player:"raya", amount: 800, status:"Success", time:"2025-09-02 12:09" },
      { id:"TX-20032", type:"Withdraw", player:"ken", amount:-1200, status:"Pending", time:"2025-09-02 13:01" },
      { id:"TX-20033", type:"Bonus",    player:"nina", amount: 70, status:"Success", time:"2025-09-02 13:44" },
    ],
    transfers: [
      { from:"Vault", to:"Bank C", amount: 5000, by:"support1", time:"2025-09-02 11:10" },
    ],
    players: [
      { user:"raya", vip:"Silver", balance: 142.00, last:"2025-09-02 12:30" },
      { user:"ken",  vip:"Gold", balance: 9.50, last:"2025-09-02 13:09" },
    ]
  }
};

/* =========================
   App State + Persistence
   ========================= */
const tabBar   = document.getElementById('tabBar');
const content  = document.getElementById('content');
const siteSel  = document.getElementById('siteSelect');
const topNav   = document.getElementById('topNav');

let tabs = []; // {id,label}
let activeTabId = null;

function saveState(){
  localStorage.setItem('admin.tabs', JSON.stringify(tabs));
  localStorage.setItem('admin.active', activeTabId || '');
  localStorage.setItem('admin.site', siteSel.value);
}
function loadState(){
  const savedSite  = localStorage.getItem('admin.site');
  if(savedSite) siteSel.value = savedSite;

  const savedTabs  = JSON.parse(localStorage.getItem('admin.tabs')||'[]');
  const savedActive= localStorage.getItem('admin.active') || null;
  if(savedTabs.length){
    tabs = savedTabs;
    renderTabBar();
    if(savedActive && tabs.find(t=>t.id===savedActive)){
      activateTab(savedActive);
    }else{
      activateTab(tabs[0].id);
    }
  }
}
siteSel.addEventListener('change', ()=>{
  saveState();
  if(activeTabId) renderContent(tabs.find(t=>t.id===activeTabId).label);
});

/* =========================
   Header clicks -> open tab
   ========================= */
topNav.addEventListener('click', (e)=>{
  const btn = e.target.closest('.nav-btn');
  if(!btn) return;
  const label = btn.dataset.tab;
  addTab(label);
});

/* =========================
   Tab creation / render
   ========================= */
function addTab(label){
  // if exists -> focus
  const exist = tabs.find(t => t.label === label);
  if(exist){ activateTab(exist.id); return; }

  const id = 'tab_'+Date.now()+'_'+Math.random().toString(16).slice(2,6);
  tabs.push({id, label});
  renderTabBar();
  activateTab(id);
  saveState();
}

function renderTabBar(){
  tabBar.innerHTML = '';
  tabs.forEach((t,i)=>{
    const el = document.createElement('div');
    el.className = 'tab';
    el.draggable = true;
    el.dataset.id = t.id;
    el.innerHTML = `
      <span class="label">${t.label}</span>
      <span class="close" title="Close">Ã—</span>
    `;
    if(t.id === activeTabId) el.classList.add('active');

    // click to activate
    el.addEventListener('click', (e)=>{
      if(e.target.classList.contains('close')) return;
      activateTab(t.id);
    });

    // close
    el.querySelector('.close').addEventListener('click', (e)=>{
      e.stopPropagation();
      closeTab(t.id);
    });

    // drag events
    el.addEventListener('dragstart', (ev)=>{
      el.classList.add('dragging');
      ev.dataTransfer.setData('text/plain', t.id);
    });
    el.addEventListener('dragend', ()=> el.classList.remove('dragging'));
    el.addEventListener('dragover', (ev)=> ev.preventDefault());
    el.addEventListener('drop', (ev)=>{
      ev.preventDefault();
      const draggedId = ev.dataTransfer.getData('text/plain');
      if(!draggedId || draggedId===t.id) return;
      reorderTabs(draggedId, t.id);
    });

    tabBar.appendChild(el);
  });
}

function activateTab(id){
  activeTabId = id;
  [...tabBar.children].forEach(ch=>{
    ch.classList.toggle('active', ch.dataset.id === id);
  });
  const label = tabs.find(t=>t.id===id)?.label || '';
  renderContent(label);
  saveState();
}

function closeTab(id){
  const idx = tabs.findIndex(t=>t.id===id);
  if(idx<0) return;
  const wasActive = (activeTabId===id);
  tabs.splice(idx,1);
  renderTabBar();
  if(!tabs.length){
    activeTabId = null;
    content.innerHTML = `
      <div class="panel"><h2>Semua tab ditutup</h2>
      <div class="muted">Klik item di header untuk membuka tab baru.</div></div>`;
  }else if(wasActive){
    const newIdx = Math.max(0, idx-1);
    activateTab(tabs[newIdx].id);
  }
  saveState();
}

function reorderTabs(dragId, dropOnId){
  const from = tabs.findIndex(t=>t.id===dragId);
  const to   = tabs.findIndex(t=>t.id===dropOnId);
  if(from<0 || to<0) return;
  const [moved] = tabs.splice(from,1);
  tabs.splice(to,0,moved);
  renderTabBar();
  saveState();
}

/* =========================
   Content renderers
   ========================= */
function renderContent(label){
  switch(label){
    case 'Dashboard': return renderDashboard();
    case 'Transactions': return renderTransactions();
    case 'Cash Transfer': return renderTransfers();
    case 'Player': return renderPlayers();
    case 'Report': return renderReports();
    case 'Livechat': return renderLivechat();
    default:
      content.innerHTML = `<div class="panel"><h2>${label}</h2><div class="muted">Content not implemented yet.</div></div>`;
  }
}

function renderDashboard(){
  content.innerHTML = `
    <div class="panel">
      <h2>Dashboard â€” <span class="muted">${siteSel.value}</span></h2>
      <div class="muted">Ringkasan metrik akan diletakkan di sini (grafik, KPI, dll).</div>
    </div>`;
}

function renderTransactions(){
  const site = siteSel.value;
  const rows = (DATA[site]?.transactions||[]).map(tx => `
    <tr>
      <td><span class="tag">${tx.type}</span></td>
      <td>${tx.id}</td>
      <td>${tx.player}</td>
      <td class="right amount ${tx.amount>=0?'pos':'neg'}">${formatMoney(tx.amount)}</td>
      <td>${badgeStatus(tx.status)}</td>
      <td>${tx.time}</td>
    </tr>
  `).join('');

  content.innerHTML = `
    <div class="panel">
      <h2>Transactions â€” <span class="muted">${site}</span></h2>

      <div class="filters">
        <input id="txSearch" class="input" placeholder="Search player / id / type..." />
        <select id="txType" class="input">
          <option value="">All Types</option>
          <option>Deposit</option>
          <option>Withdraw</option>
          <option>Bonus</option>
        </select>
        <button class="button">Today</button>
        <button class="button">This Week</button>
        <button class="button gold" id="refreshTx">Refresh</button>
        <span class="spacer"></span>
        <span class="badge">Site: ${site}</span>
      </div>

      <div class="table-wrap">
        <table id="txTable">
          <thead>
            <tr>
              <th>Type</th><th>Txn ID</th><th>Player</th>
              <th class="right">Amount</th><th>Status</th><th>Time</th>
            </tr>
          </thead>
          <tbody>${rows || `<tr><td colspan="6" class="muted">No data</td></tr>`}</tbody>
        </table>
      </div>
    </div>
  `;

  // simple filters
  const search = document.getElementById('txSearch');
  const typeSel= document.getElementById('txType');
  document.getElementById('refreshTx').addEventListener('click', ()=> renderTransactions());

  const applyFilter = ()=>{
    const term = (search.value||'').toLowerCase();
    const type = typeSel.value;
    const all  = (DATA[site]?.transactions||[]);
    const filtered = all.filter(tx=>{
      const hitTerm = !term || [tx.id, tx.player, tx.type].join(' ').toLowerCase().includes(term);
      const hitType = !type || tx.type===type;
      return hitTerm && hitType;
    });
    const body = document.querySelector('#txTable tbody');
    body.innerHTML = filtered.map(tx => `
      <tr>
        <td><span class="tag">${tx.type}</span></td>
        <td>${tx.id}</td>
        <td>${tx.player}</td>
        <td class="right amount ${tx.amount>=0?'pos':'neg'}">${formatMoney(tx.amount)}</td>
        <td>${badgeStatus(tx.status)}</td>
        <td>${tx.time}</td>
      </tr>
    `).join('') || `<tr><td colspan="6" class="muted">No data</td></tr>`;
  };
  search.addEventListener('input', applyFilter);
  typeSel.addEventListener('change', applyFilter);
}

function renderTransfers(){
  const site = siteSel.value;
  const rows = (DATA[site]?.transfers||[]).map(r=>`
    <tr>
      <td>${r.from}</td><td>â†’</td><td>${r.to}</td>
      <td class="right amount pos">${formatMoney(r.amount)}</td>
      <td>${r.by}</td><td>${r.time}</td>
    </tr>
  `).join('');

  content.innerHTML = `
    <div class="panel">
      <h2>Cash Transfer â€” <span class="muted">${site}</span></h2>
      <table>
        <thead><tr><th>From</th><th></th><th>To</th><th class="right">Amount</th><th>By</th><th>Time</th></tr></thead>
        <tbody>${rows || `<tr><td colspan="6" class="muted">No data</td></tr>`}</tbody>
      </table>
    </div>
  `;
}

function renderPlayers(){
  const site = siteSel.value;
  const rows = (DATA[site]?.players||[]).map(p=>`
    <tr>
      <td>${p.user}</td>
      <td><span class="tag">${p.vip}</span></td>
      <td class="right">${formatMoney(p.balance)}</td>
      <td>${p.last}</td>
    </tr>
  `).join('');
  content.innerHTML = `
    <div class="panel">
      <h2>Player â€” <span class="muted">${site}</span></h2>
      <table>
        <thead><tr><th>User</th><th>VIP</th><th class="right">Balance</th><th>Last Active</th></tr></thead>
        <tbody>${rows || `<tr><td colspan="4" class="muted">No data</td></tr>`}</tbody>
      </table>
    </div>
  `;
}

function renderReports(){
  content.innerHTML = `
    <div class="panel">
      <h2>Report</h2>
      <div class="muted">Tempat untuk report & grafik. (Boleh tambah kemudian)</div>
    </div>
  `;
}

function renderLivechat(){
  content.innerHTML = `
    <div class="panel">
      <h2>Livechat</h2>
      <div class="muted">Embed / iframe livechat kamu boleh dimasukkan di sini.</div>
    </div>
  `;
}

/* =========================
   Helpers
   ========================= */
function formatMoney(v){
  const sign = v<0 ? '-' : '';
  const n = Math.abs(v).toLocaleString(undefined,{minimumFractionDigits:2,maximumFractionDigits:2});
  return sign + n;
}
function badgeStatus(s){
  const color = s==='Success' ? 'style="color:#8bf59d"' :
                s==='Pending' ? 'style="color:#ffd073"' :
                'style="color:#ff9b9b"';
  return `<span ${color}>${s}</span>`;
}

/* =========================
   Boot
   ========================= */
loadState();

// Convenience: open default tabs first time
if(!tabs.length){
  ['Dashboard','Transactions','Cash Transfer','Player','Livechat'].forEach(addTab);
}

</script>
</body>
</html>
